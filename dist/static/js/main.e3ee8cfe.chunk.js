(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{229:function(e,t,a){e.exports=a(497)},234:function(e,t,a){},404:function(e,t,a){},425:function(e,t){},470:function(e,t,a){},497:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(136),l=a.n(s),c=(a(234),a(15)),i=a(16),o=a(18),u=a(17),m=a(19),h=a(504),d=a(506),f=a(253),p=a(255),g=a(500),E=a(137),b=a.n(E),v=a(8),O=a(47),N=a.n(O);a(251),a(252);N.a.initializeApp({apiKey:"AIzaSyAIIRu8xg6Jl-reewB9IKYk9NPzSz2rZNM",authDomain:"react-redux-firebase-1512214.firebaseapp.com",databaseURL:"https://react-redux-firebase-1512214.firebaseio.com",projectId:"react-redux-firebase-1512214",storageBucket:"",messagingSenderId:"375933914937"}),N.a.firestore().settings({timestampsInSnapshots:!0});var y=new N.a.auth.GoogleAuthProvider,j=N.a.storage(),w=N.a,S=Object(v.b)(function(e){return{auth:e.firebase.auth}},function(e){return{signOut:function(){return e(function(e,t,a){(0,a.getFirebase)().auth().signOut().then(function(){e({type:"SIGNOUT_SUCCESS"})})})}}})(function(e){return r.a.createElement("ul",{className:"right"},r.a.createElement("li",null,r.a.createElement("a",{onClick:e.signOut},"Log Out")),r.a.createElement("li",null,r.a.createElement(g.a,{to:"/",className:"btn pink lighten"},"Xin ch\xe0o ",e.auth.email,"!!")))}),C=function(){return r.a.createElement("div",null)},x=Object(v.b)(function(e){return console.log(e),{auth:e.firebase.auth}})(function(e){var t=e.auth.uid?r.a.createElement(S,null):r.a.createElement(C,null);return r.a.createElement("div",null,r.a.createElement("nav",{className:"nav-wrapper grey darken-3"},r.a.createElement(p.a,{to:"/",className:"brand-logo"},"1512214-FireBase-ChatApp"),t),r.a.createElement("br",null),r.a.createElement("br",null))}),I=a(20),U=a(11),A=a(505),F=(a(404),a(502));a(501),a(503),a(140),a(228);var R=a(86),k=a.n(R),_=(a(416),function(e){function t(e){var a;Object(c.a)(this,t);(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).props.dataChat;return a.state={},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.profile;e.uid?e.uid:e.UID,e.display_name?e.display_name:e.displayName;return r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"chat-header clearfix"},r.a.createElement("div",{className:"logo"},r.a.createElement("img",{src:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/195612/chat_avatar_01_green.jpg",alt:"logo"})),r.a.createElement("div",{class:"chat-about"},r.a.createElement("div",{class:"chat-with"},"Chat with Vincent Porter"),r.a.createElement("div",{class:"chat-num-messages"},"already 1 902 messages")),r.a.createElement("i",{class:"fa fa-star"})),r.a.createElement("div",{class:"chat-history"},r.a.createElement("ul",null,r.a.createElement("li",{class:"clearfix"},r.a.createElement("div",{class:"message-data align-right"},r.a.createElement("span",{class:"message-data-time"},"10:10 AM, Today")," \xa0 \xa0",r.a.createElement("span",{class:"message-data-name"},"Olia")," ",r.a.createElement("i",{class:"fa fa-circle me"})),r.a.createElement("div",{class:"message other-message float-right"},"Hi Vincent, how are you? How is the project coming along?")),r.a.createElement("li",null,r.a.createElement("div",{class:"message-data"},r.a.createElement("span",{class:"message-data-name"},r.a.createElement("i",{class:"fa fa-circle online"})," Vincent"),r.a.createElement("span",{class:"message-data-time"},"10:12 AM, Today")),r.a.createElement("div",{class:"message my-message"},"Are we meeting today? Project has been already finished and I have results to show you.")),r.a.createElement("li",{class:"clearfix"},r.a.createElement("div",{class:"message-data align-right"},r.a.createElement("span",{class:"message-data-time"},"10:14 AM, Today")," \xa0 \xa0",r.a.createElement("span",{class:"message-data-name"},"Olia")," ",r.a.createElement("i",{class:"fa fa-circle me"})),r.a.createElement("div",{class:"message other-message float-right"},"Well I am not sure. The rest of the team is not here yet. Maybe in an hour or so? Have you faced any problems at the last phase of the project?")),r.a.createElement("li",null,r.a.createElement("div",{class:"message-data"},r.a.createElement("span",{class:"message-data-name"},r.a.createElement("i",{class:"fa fa-circle online"})," Vincent"),r.a.createElement("span",{class:"message-data-time"},"10:20 AM, Today")),r.a.createElement("div",{class:"message my-message"},"Actually everything was fine. I'm very excited to show this to our team.")),r.a.createElement("li",null,r.a.createElement("div",{class:"message-data"},r.a.createElement("span",{class:"message-data-name"},r.a.createElement("i",{class:"fa fa-circle online"})," Vincent"),r.a.createElement("span",{class:"message-data-time"},"10:31 AM, Today")),r.a.createElement("i",{class:"fa fa-circle online"}),r.a.createElement("i",{class:"fa fa-circle online",style:{color:"#AED2A6"}}),r.a.createElement("i",{class:"fa fa-circle online",style:{color:"#DAE9DA"}})))),r.a.createElement("div",{className:"chat-message clearfix"},r.a.createElement("form",null,r.a.createElement("textarea",{name:"message-to-send",id:"message-to-send",placeholder:"Type message!!",rows:3,defaultValue:""}),r.a.createElement("span",{className:"media"},r.a.createElement("div",{className:"image-box"},r.a.createElement("div",{className:"preview-box"},this.state.files&&this.state.files.map(function(e,t){return r.a.createElement("div",{className:"tag",key:t},r.a.createElement("button",{type:"button",className:"close-x"},r.a.createElement("span",null,"X")),r.a.createElement("p",null,e.name))}))),r.a.createElement("button",{type:"button"},"Send")))))}}]),t}(n.Component)),P=Object(F.a)(Object(U.d)(I.withFirestore,Object(v.b)(function(e){return{profile:e.firebase.profile}},function(e){return{sendMessage:function(t,a){return e(function(e,t){return function(a,n,r){var s=r.getFirebase,l=(0,r.getFirestore)(),c=s().auth().O;if(e.content||e.files.length){var i=e.messages,o=new Date,u=u(c,e.infoUser.uid),m="",h=[];if(e.content&&(m=e.content),e.files.length){var d=j.ref(),f=[];e.files.forEach(function(e){var t=d.child("images/".concat((new Date).getTime())).put(e);f.push(t)}),Promise.all(f).then(function(e){e.forEach(function(e){e.ref.getDownloadURL().then(function(e){h.push(e)})})}).then(function(){i.push({belongTo:c,chatAt:o.toString(),content:m,images:h}),console.log(i),l.get({collection:"chatbox",where:["id","==",u]}).then(function(e){if(e.docs.length){var a=e.docs[0].id;l.update({collection:"chatbox",doc:a},{lastChatAt:o.toString(),messages:i}).then(function(){t()})}else l.collection("chatbox").doc(u).set({id:u,lastChatAt:o.toString(),messages:i})})}).catch(function(e){return console.log(e)})}else i.push({belongTo:c,chatAt:o.toString(),content:m,images:h}),l.get({collection:"chatbox",where:["id","==",u]}).then(function(e){if(e.docs.length){var a=e.docs[0].id;l.update({collection:"chatbox",doc:a},{lastChatAt:o.toString(),messages:i}).then(function(){t()})}else l.collection("chatbox").doc(u).set({id:u,lastChatAt:o.toString(),messages:i})})}}}(t,a))}}}))(_)),G=(a(219),a(468),a(469),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={active:!1},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){console.log(this.props);var e=this.props.user;return r.a.createElement("div",null,r.a.createElement(p.a,{to:"/chatwith/"+e.UID},r.a.createElement("li",{className:this.state.active?"clearfix active":"clearfix"},r.a.createElement("img",{width:"55",src:e.photoURL,alt:"avatar"}),r.a.createElement("div",{className:"about"},r.a.createElement("div",{className:"name"},e.display_name),r.a.createElement("div",{className:"status"},r.a.createElement("i",{className:"online"===e.status?"fa fa-circle online":"fa fa-circle offline"}),e.status)))))}}]),t}(n.Component)),L=Object(F.a)(Object(U.d)(I.withFirestore,Object(v.b)(function(e){var t=e.firebase.profile&&e.firebase.profile.isEmpty?e.firebase.auth:e.firebase.profile,a=t.uid?t.uid:t.UID,n=[];if(e.firestore.data.users){var r=k.a.values(e.firestore.data.users).find(function(e){return a===e.UID});r&&(n=r.stars)}return{myUID:a,stars:n}},function(e){return{updateUserChatInfo:function(t){return e(function(e){return{type:"INFO_CHAT_USER",info:e}}(t))}}}))(G)),D=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={name:""},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return console.log(this.props),r.a.createElement("div",{className:"people-list",id:"people-list"},r.a.createElement("div",{className:"search"},r.a.createElement("input",{type:"text",placeholder:"Search"})),r.a.createElement("ul",{className:"list"},!!this.props.listPeople.length&&this.props.listPeople.map(function(e,t){return r.a.createElement(L,{user:e,key:t})})))}}]),t}(n.Component),T=Object(F.a)(Object(U.d)(I.withFirestore,Object(v.b)(function(e){var t=[];t=e.firestore.data.users;var a=e.firebase.auth,n=[];if(t){t=Object.entries(t);for(var r=0;r<t.length;r++)t[r][1].UID!=a.uid&&n.push(t[r][1])}return{listPeople:n,currentPeople:a}},function(e){return{}}))(D)),W=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props;e.projects;return e.auth.uid?r.a.createElement("div",{className:"container clearfix"},r.a.createElement(T,null),r.a.createElement(P,null)):r.a.createElement(A.a,{to:"/signin"})}}]),t}(n.Component),M=Object(U.d)(Object(v.b)(function(e){return console.log(e),{projects:e.firestore.ordered.projects,auth:e.firebase.auth}}),Object(I.firestoreConnect)(["users","chat"]))(W),z=a(46),B=(a(470),new b.a.auth.GoogleAuthProvider,function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:""},a.handleChange=function(e){a.setState(Object(z.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.signIn(a.state)},a.handleGoogleSignin=function(){a.props.loginWithGoogle()},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.authError;return e.auth.uid?r.a.createElement(A.a,{to:"/"}):r.a.createElement("div",{className:"text-center",style:{width:"40%",margin:"40px auto",backgroundColor:"white"}},r.a.createElement("form",{id:"formLogin",onSubmit:this.handleSubmit},r.a.createElement("h5",{className:"grey-text text-darken-3"},"Sign In"),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{type:"email",id:"email",className:"validate",onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"email"},"Email")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{type:"password",id:"password",className:"validate",onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"password"},"Password")),r.a.createElement("div",{className:"input-field text-center"},r.a.createElement("button",{className:"btn teal lighten-1 z-depth-0"},"Login"),r.a.createElement("div",{className:"red-text center"},t?r.a.createElement("span",null,"Login failed!!! Wrong email or password"):null))),r.a.createElement("p",{className:"grey-text text-darken-3"},"You don't have account ?"),r.a.createElement("a",{href:"/signup"},"Sign up now"),r.a.createElement("div",{className:"text-center"},r.a.createElement("button",{className:"loginBtn loginBtn--google",onClick:this.handleGoogleSignin.bind(this)},"Login with Google")))}}]),t}(n.Component)),V=Object(v.b)(function(e){return{authError:e.auth.authError,auth:e.firebase.auth}},function(e){return{signIn:function(t){return e((a=t,function(e,t,n){(0,n.getFirebase)().auth().signInWithEmailAndPassword(a.email,a.password).then(function(){e({type:"LOGIN_SUCCESS"})}).catch(function(t){e({type:"LOGIN_ERROR",err:t})})}));var a},loginWithGoogle:function(){return e(function(e,t,a){var n=a.getFirebase,r=a.getFirestore,s=n(),l=r();s.auth().signInWithPopup(y).then(function(t){e({type:"LOGIN_SUCCESS"});var a=t.user;l.collection("users").doc(t.user.uid).set({display_name:a.displayName,username:a.displayName,photoURL:a.photoURL,email:a.email,phoneNumber:a.phoneNumber,status:"offline",UID:a.uid})}).catch(function(t){e({type:"LOGIN_ERROR",err:t})})})}}})(B),H=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:"",firstName:"",lastName:""},a.handleChange=function(e){a.setState(Object(z.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.signUp(a.state)},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.auth,a=e.authError;return t.uid?r.a.createElement(A.a,{to:"/"}):r.a.createElement("div",{className:"text-center",style:{width:"40%",margin:"40px auto",backgroundColor:"white"}},r.a.createElement("form",{className:"white",onSubmit:this.handleSubmit},r.a.createElement("h5",{className:"grey-text text-darken-3"},"Sign Up"),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{type:"email",id:"email",className:"validate",onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"email"},"Email")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{type:"password",id:"password",className:"validate",onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"password"},"Password")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{type:"text",id:"firstName",className:"validate",onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"firstName"},"First Name")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{type:"text",id:"lastName",className:"validate",onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"lastName"},"Last Name")),r.a.createElement("div",{className:"input-field text-center"},r.a.createElement("button",{className:"btn teal lighten-1 z-depth-0"},"Sign Up"),r.a.createElement("div",{className:"red-text center"},a?r.a.createElement("span",null,a):null))),r.a.createElement("p",{className:"grey-text text-darken-3"},"You had account ?"),r.a.createElement("a",{href:"/signin"},"Log in now"))}}]),t}(n.Component),J=Object(v.b)(function(e){return{auth:e.firebase.auth,authError:e.auth.authError}},function(e){return{signUp:function(t){return e(function(e){return function(t,a,n){var r=n.getFirebase,s=n.getFirestore,l=r(),c=s();l.auth().createUserWithEmailAndPassword(e.email,e.password).then(function(t){return c.collection("users").doc(t.user.uid).set({firstName:e.firstName,lastName:e.lastName,initials:e.firstName[0]+e.lastName[0]})}).then(function(){t({type:"SIGNUP_SUCCESS"})}).catch(function(e){t({type:"SIGNUP_ERROR",err:e})})}}(t))}}})(H),Y=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(x,null),r.a.createElement(d.a,null,r.a.createElement(f.a,{exact:!0,path:"/",component:M}),r.a.createElement(f.a,{exact:!0,path:"/chatwith/:id",component:M}),r.a.createElement(f.a,{path:"/signin",component:V}),r.a.createElement(f.a,{path:"/signup",component:J}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var K=a(38),X={authError:null},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return console.log("login error"),Object(K.a)({},e,{authError:"Login failed"});case"LOGIN_SUCCESS":return console.log("login success"),Object(K.a)({},e,{authError:null});case"SIGNOUT_SUCCESS":return console.log("signout success"),e;case"SIGNUP_SUCCESS":return Object(K.a)({},e,{authError:null});case"SIGNUP_ERROR":return console.log("signup error"),Object(K.a)({},e,{authError:t.err.message});default:return e}},$=a(62),q={infoUser:null},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INFO_CHAT_USER":return Object(K.a)({},e,{infoUser:t.info});default:return e}},ee=Object(U.c)({auth:Z,firestore:$.firestoreReducer,firebase:I.firebaseReducer,chat:Q}),te=a(227),ae=Object(U.e)(ee,Object(U.d)(Object(U.a)(te.a.withExtraArgument({getFirebase:I.getFirebase,getFirestore:$.getFirestore})),Object($.reduxFirestore)(w),Object(I.reactReduxFirebase)(w,{userProfile:"users",presence:"presence",sessions:"sessions",attachAuthIsReady:!0,useFirestoreForProfile:!0})));ae.firebaseAuthIsReady.then(function(){l.a.render(r.a.createElement(v.a,{store:ae},r.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})})}},[[229,2,1]]]);
//# sourceMappingURL=main.e3ee8cfe.chunk.js.map